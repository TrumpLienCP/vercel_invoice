<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>é€²è²¨å–®è¾¨è­˜å·¥å…·</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
    input, button, table { margin: 0.5em 0; width: 100%; max-width: 800px; }
    label { font-weight: bold; display: block; margin-top: 1em; }
    table { border-collapse: collapse; width: 100%; margin-top: 1em; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: left; }
    #log { height: 150px; overflow-y: auto; background: #f0f0f0; padding: 1em; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h1>é€²è²¨å–®è¾¨è­˜å·¥å…· (ChatGPT + Vercel)</h1>

  <label>é¸æ“‡åœ–ç‰‡ï¼š</label>
  <input type="file" id="image-input" accept="image/*" />
  <button onclick="upload()">è¾¨è­˜åœ–ç‰‡</button>

  <div id="log">ç­‰å¾…æ“ä½œ...</div>

  <table id="result-table">
    <thead>
      <tr><th>å“è™Ÿ</th><th>å“å</th><th>å–®ä½</th><th>å–®åƒ¹</th></tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    async function upload() {
      const input = document.getElementById("image-input");
      if (!input.files[0]) return alert("è«‹é¸æ“‡åœ–ç‰‡");

      const log = document.getElementById("log");
      log.innerText = "ğŸ“¤ ä¸Šå‚³ä¸­...";

      const formData = new FormData();
      formData.append("image", input.files[0]);

      const res = await fetch("/api/gpt-vision", { method: "POST", body: formData });
      const result = await res.json();

      log.innerText = "âœ… è¾¨è­˜å®Œæˆ";

      const tbody = document.querySelector("#result-table tbody");
      tbody.innerHTML = "";
      for (const row of result.items) {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td>${row.code}</td><td>${row.name}</td><td>${row.unit}</td><td>${row.price}</td>`;
        tbody.appendChild(tr);
      }
    }
  </script>
</body>
</html>
